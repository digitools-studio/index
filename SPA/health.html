<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨æ–¹ä½å¥åº·æ•¸æ“šè¨ˆç®—æ©Ÿ (æ“´å……ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            flex-direction: column;
        }
        main {
            flex-grow: 1;
        }
        /* è‡ªå®šç¾©å‹•ç•« */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        /* è®“ input[type=number] éš±è—ä¸Šä¸‹ç®­é ­ */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="p-4">

    <!-- ä¸»å®¹å™¨ -->
    <main class="flex items-center justify-center w-full">
        <div class="w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-10">
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-gray-800">å…¨æ–¹ä½å¥åº·æ•¸æ“šè¨ˆç®—æ©Ÿ</h1>
                <p class="text-gray-500 mt-2">è¼¸å…¥æ‚¨çš„åŸºæœ¬è³‡æ–™ï¼Œå¥åº·åˆ†æå ±å‘Šå°‡æœƒå³æ™‚æ›´æ–°ã€‚</p>
            </div>

            <!-- è¼¸å…¥è¡¨å–® -->
            <form id="health-form" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- åŸºæœ¬è³‡æ–™ -->
                <div class="form-group">
                    <label for="gender" class="block text-sm font-medium text-gray-700 mb-2">æ€§åˆ¥</label>
                    <select id="gender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option value="male">ç”·æ€§</option>
                        <option value="female">å¥³æ€§</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="age" class="block text-sm font-medium text-gray-700 mb-2">å¹´é½¡ (æ­²)</label>
                    <input type="number" id="age" placeholder="è«‹è¼¸å…¥" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" min="1" max="120">
                </div>
                <div class="form-group">
                    <label for="weight" class="block text-sm font-medium text-gray-700 mb-2">é«”é‡ (å…¬æ–¤)</label>
                    <input type="number" id="weight" placeholder="ä¾‹å¦‚ï¼š70" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" min="1" step="0.1">
                </div>
                <div class="form-group">
                    <label for="height" class="block text-sm font-medium text-gray-700 mb-2">èº«é«˜ (å…¬åˆ†)</label>
                    <input type="number" id="height" placeholder="ä¾‹å¦‚ï¼š175" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" min="1" step="0.1">
                </div>
                <!-- åœåº¦è³‡æ–™ (ç”¨æ–¼é«”è„‚è¨ˆç®—) -->
                 <div class="form-group">
                    <label for="neck" class="block text-sm font-medium text-gray-700 mb-2">é ¸åœ (å…¬åˆ†)</label>
                    <input type="number" id="neck" placeholder="é¸å¡«" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" min="1" step="0.1">
                </div>
                 <div class="form-group">
                    <label for="waist" class="block text-sm font-medium text-gray-700 mb-2">è…°åœ (å…¬åˆ†)</label>
                    <input type="number" id="waist" placeholder="é¸å¡«" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" min="1" step="0.1">
                </div>
                <div id="hip-group" class="form-group hidden">
                    <label for="hip" class="block text-sm font-medium text-gray-700 mb-2">è‡€åœ (å…¬åˆ†)</label>
                    <input type="number" id="hip" placeholder="é¸å¡«" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" min="1" step="0.1">
                </div>
            </form>
            
            <!-- æç¤ºè¨Šæ¯ -->
            <div id="prompt-message" class="text-center text-gray-400 p-3 rounded-lg mb-6">è«‹å¡«å¯«ä¸Šæ–¹å¿…å¡«æ¬„ä½ä»¥æŸ¥çœ‹åŸºç¤åˆ†æã€‚å¡«å¯«é ¸åœã€è…°åœç­‰æ•¸æ“šå¯ç²å¾—æ›´è©³ç´°å ±å‘Šã€‚</div>

            <!-- çµæœé¡¯ç¤ºå€ -->
            <div id="results-container" class="hidden">
                <!-- ç¸½çµ -->
                <div id="summary" class="text-center bg-blue-50 border-l-4 border-blue-500 text-blue-800 p-5 rounded-r-lg mb-8"></div>

                <!-- è©³ç´°æ•¸æ“šå¡ç‰‡ -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- BMI -->
                    <div id="bmi-card" class="p-6 rounded-lg shadow-md"></div>
                    <!-- BMR -->
                    <div id="bmr-card" class="bg-white p-6 rounded-lg shadow-md"></div>
                    <!-- ç†æƒ³é«”é‡ -->
                    <div id="ideal-weight-card" class="bg-white p-6 rounded-lg shadow-md"></div>
                    <!-- é«”è„‚ç‡ (BFP) -->
                    <div id="bfp-card" class="p-6 rounded-lg shadow-md hidden"></div>
                    <!-- é™¤è„‚é«”é‡ (LBM) -->
                    <div id="lbm-card" class="bg-white p-6 rounded-lg shadow-md hidden"></div>
                    <!-- è…°é«˜æ¯” (WHtR) -->
                    <div id="whtr-card" class="p-6 rounded-lg shadow-md hidden"></div>
                    <!-- TDEE -->
                    <div id="tdee-card" class="bg-white p-6 rounded-lg shadow-md md:col-span-2 lg:col-span-3"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- é å°¾ -->
    <footer class="text-center mt-10 p-6 text-sm text-gray-500">
        <div class="max-w-4xl mx-auto">
            <p>&copy; 2024 å…¨æ–¹ä½å¥åº·æ•¸æ“šè¨ˆç®—æ©Ÿ. All Rights Reserved.</p>
            <p class="mt-2">
                <a href="#" class="hover:underline">éš±ç§æ¬Šæ”¿ç­–</a> | 
                <a href="#" class="hover:underline">æœå‹™æ¢æ¬¾</a> | 
                <span>Powered by <a href="#" target="_blank" rel="noopener noreferrer" class="font-semibold text-gray-600 hover:text-blue-600">æ•¸è½‰å·¥ä½œå®¤</a></span>
            </p>
        </div>
    </footer>

    <script>
        // DOM å…ƒç´ 
        const inputs = document.querySelectorAll('input, select');
        const resultsContainer = document.getElementById('results-container');
        const promptMessage = document.getElementById('prompt-message');
        const genderSelect = document.getElementById('gender');
        const hipGroup = document.getElementById('hip-group');

        // ç›£è½æ€§åˆ¥é¸æ“‡ï¼Œå‹•æ…‹é¡¯ç¤º/éš±è—è‡€åœè¼¸å…¥
        genderSelect.addEventListener('change', () => {
            if (genderSelect.value === 'female') {
                hipGroup.classList.remove('hidden');
            } else {
                hipGroup.classList.add('hidden');
            }
            calculateAndDisplay(); // æ€§åˆ¥æ”¹è®Šæ™‚ä¹Ÿé‡æ–°è¨ˆç®—
        });

        // è¨ˆç®—ä¸¦é¡¯ç¤ºçµæœçš„å‡½æ•¸
        const calculateAndDisplay = () => {
            // 1. ç²å–åŸºæœ¬è¼¸å…¥å€¼
            const gender = genderSelect.value;
            const age = parseInt(document.getElementById('age').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            
            // 2. é©—è­‰åŸºæœ¬è¼¸å…¥
            if (!age || !weight || !height || age <= 0 || weight <= 0 || height <= 0) {
                resultsContainer.classList.add('hidden');
                promptMessage.classList.remove('hidden');
                return;
            }
            promptMessage.classList.add('hidden');

            // --- åŸºç¤æŒ‡æ¨™è¨ˆç®— ---
            const heightInMeters = height / 100;
            const bmi = weight / (heightInMeters * heightInMeters);
            
            let bmiStatus, bmiColorClass;
            // ... (BMI ç‹€æ…‹åˆ¤æ–·é‚è¼¯ï¼Œèˆ‡å‰ä¸€ç‰ˆç›¸åŒ)
            if (bmi < 18.5) { bmiStatus = 'é«”é‡éè¼•'; bmiColorClass = { text: 'text-blue-600', bg: 'bg-blue-100' }; } 
            else if (bmi < 24) { bmiStatus = 'æ­£å¸¸ç¯„åœ'; bmiColorClass = { text: 'text-green-600', bg: 'bg-green-100' }; } 
            else if (bmi < 27) { bmiStatus = 'éé‡'; bmiColorClass = { text: 'text-yellow-600', bg: 'bg-yellow-100' }; } 
            else if (bmi < 30) { bmiStatus = 'è¼•åº¦è‚¥èƒ–'; bmiColorClass = { text: 'text-orange-600', bg: 'bg-orange-100' }; } 
            else if (bmi < 35) { bmiStatus = 'ä¸­åº¦è‚¥èƒ–'; bmiColorClass = { text: 'text-red-600', bg: 'bg-red-100' }; } 
            else { bmiStatus = 'é‡åº¦è‚¥èƒ–'; bmiColorClass = { text: 'text-red-800', bg: 'bg-red-200' }; }

            const bmr = (gender === 'male')
                ? (10 * weight + 6.25 * height - 5 * age + 5)
                : (10 * weight + 6.25 * height - 5 * age - 161);
            
            const idealWeightLower = 18.5 * (heightInMeters * heightInMeters);
            const idealWeightUpper = 24 * (heightInMeters * heightInMeters);

            // --- æ¸²æŸ“åŸºç¤æŒ‡æ¨™ ---
            document.getElementById('summary').innerHTML = `<p class="text-lg">æ‚¨çš„ <strong>BMI ç‚º ${bmi.toFixed(1)}</strong>ï¼Œå±¬æ–¼ã€Œ<span class="font-bold ${bmiColorClass.text}">${bmiStatus}</span>ã€ç¯„åœã€‚åŸºç¤ä»£è¬ç‡ (BMR) ç´„ç‚º <strong>${bmr.toFixed(0)} å¤§å¡</strong>ã€‚</p>`;
            
            const bmiCard = document.getElementById('bmi-card');
            bmiCard.className = `p-6 rounded-lg shadow-md ${bmiColorClass.bg}`;
            bmiCard.innerHTML = `<div class="flex items-center mb-3"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><h3 class="text-lg font-semibold">èº«é«”è³ªé‡æŒ‡æ•¸ (BMI)</h3></div><p class="text-3xl font-bold ${bmiColorClass.text}">${bmi.toFixed(1)}</p><p class="text-sm font-medium mt-1 ${bmiColorClass.text}">${bmiStatus}</p>`;
            
            document.getElementById('bmr-card').innerHTML = `<div class="flex items-center mb-3 text-gray-700"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><h3 class="text-lg font-semibold">åŸºç¤ä»£è¬ç‡ (BMR)</h3></div><p class="text-3xl font-bold text-gray-800">${bmr.toFixed(0)} <span class="text-base font-medium">å¤§å¡/æ—¥</span></p><p class="text-sm text-gray-500 mt-1">ç¶­æŒç”Ÿå‘½æ‰€éœ€æœ€ä½ç†±é‡</p>`;
            
            document.getElementById('ideal-weight-card').innerHTML = `<div class="flex items-center mb-3 text-gray-700"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path></svg><h3 class="text-lg font-semibold">ç†æƒ³é«”é‡ç¯„åœ</h3></div><p class="text-3xl font-bold text-gray-800">${idealWeightLower.toFixed(1)} - ${idealWeightUpper.toFixed(1)} <span class="text-base font-medium">å…¬æ–¤</span></p><p class="text-sm text-gray-500 mt-1">åŸºæ–¼å¥åº·BMIå€é–“ (18.5-24)</p>`;

            const tdeeFactors = [ { label: 'ä¹…å', value: 1.2, emoji: ' sedentary' }, { label: 'è¼•åº¦æ´»å‹•', value: 1.375, emoji: 'ğŸƒ' }, { label: 'ä¸­åº¦æ´»å‹•', value: 1.55, emoji: 'ğŸ’ª' }, { label: 'é«˜åº¦æ´»å‹•', value: 1.725, emoji: 'ğŸ”¥' }, { label: 'æ¥µåº¦æ´»å‹•', value: 1.9, emoji: 'ğŸš€' } ];
            const tdeeListHTML = tdeeFactors.map(f => `<li class="flex justify-between items-center p-2 rounded-md hover:bg-gray-50"><span>${f.emoji} ${f.label}</span><strong class="text-blue-600">${(bmr * f.value).toFixed(0)} å¤§å¡</strong></li>`).join('');
            document.getElementById('tdee-card').innerHTML = `<div class="flex items-center mb-4 text-gray-700"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg><h3 class="text-lg font-semibold">æ¯æ—¥ç¸½æ¶ˆè€—ç†±é‡ (TDEE)</h3></div><ul class="space-y-3 text-gray-600">${tdeeListHTML}</ul>`;

            // --- é€²éšæŒ‡æ¨™è¨ˆç®—èˆ‡æ¸²æŸ“ ---
            const neck = parseFloat(document.getElementById('neck').value);
            const waist = parseFloat(document.getElementById('waist').value);
            const hip = parseFloat(document.getElementById('hip').value);
            
            const bfpCard = document.getElementById('bfp-card');
            const lbmCard = document.getElementById('lbm-card');
            const whtrCard = document.getElementById('whtr-card');

            // é©—è­‰é€²éšæŒ‡æ¨™æ‰€éœ€çš„è¼¸å…¥
            const isAdvancedDataValid = (gender === 'male' && neck && waist) || (gender === 'female' && neck && waist && hip);

            if (isAdvancedDataValid) {
                let bfp = 0;
                // ç¾åœ‹æµ·è»å…¬å¼è¨ˆç®— BFP
                if (gender === 'male') {
                    bfp = 86.010 * Math.log10(waist - neck) - 70.041 * Math.log10(height) + 36.76;
                } else {
                    bfp = 163.205 * Math.log10(waist + hip - neck) - 97.684 * Math.log10(height) - 78.387;
                }
                bfp = Math.max(0, bfp); // ç¢ºä¿é«”è„‚ç‡ä¸ç‚ºè² 

                const lbm = weight * (1 - (bfp / 100));
                const whtr = waist / height;

                // BFP ç‹€æ…‹åˆ¤æ–·
                let bfpStatus, bfpColorClass;
                if(gender === 'male'){
                    if(bfp < 6) { bfpStatus = 'éä½'; bfpColorClass = { text: 'text-blue-600', bg: 'bg-blue-100' }; }
                    else if(bfp <= 17) { bfpStatus = 'å¥åº·'; bfpColorClass = { text: 'text-green-600', bg: 'bg-green-100' }; }
                    else if(bfp <= 25) { bfpStatus = 'åé«˜'; bfpColorClass = { text: 'text-yellow-600', bg: 'bg-yellow-100' }; }
                    else { bfpStatus = 'è‚¥èƒ–'; bfpColorClass = { text: 'text-red-600', bg: 'bg-red-100' }; }
                } else { // female
                    if(bfp < 14) { bfpStatus = 'éä½'; bfpColorClass = { text: 'text-blue-600', bg: 'bg-blue-100' }; }
                    else if(bfp <= 24) { bfpStatus = 'å¥åº·'; bfpColorClass = { text: 'text-green-600', bg: 'bg-green-100' }; }
                    else if(bfp <= 31) { bfpStatus = 'åé«˜'; bfpColorClass = { text: 'text-yellow-600', bg: 'bg-yellow-100' }; }
                    else { bfpStatus = 'è‚¥èƒ–'; bfpColorClass = { text: 'text-red-600', bg: 'bg-red-100' }; }
                }

                // WHtR ç‹€æ…‹åˆ¤æ–·
                let whtrStatus, whtrColorClass;
                if(whtr < 0.4) { whtrStatus = 'éç˜¦'; whtrColorClass = { text: 'text-blue-600', bg: 'bg-blue-100' }; }
                else if(whtr < 0.5) { whtrStatus = 'å¥åº·'; whtrColorClass = { text: 'text-green-600', bg: 'bg-green-100' }; }
                else if(whtr < 0.6) { whtrStatus = 'è¶…é‡'; whtrColorClass = { text: 'text-yellow-600', bg: 'bg-yellow-100' }; }
                else { whtrStatus = 'è‚¥èƒ–'; whtrColorClass = { text: 'text-red-600', bg: 'bg-red-100' }; }

                // æ¸²æŸ“é€²éšæŒ‡æ¨™å¡ç‰‡
                bfpCard.className = `p-6 rounded-lg shadow-md ${bfpColorClass.bg}`;
                bfpCard.innerHTML = `<div class="flex items-center mb-3"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg><h3 class="text-lg font-semibold">é«”è„‚ç‡ (BFP)</h3></div><p class="text-3xl font-bold ${bfpColorClass.text}">${bfp.toFixed(1)}<span class="text-base font-medium">%</span></p><p class="text-sm font-medium mt-1 ${bfpColorClass.text}">${bfpStatus}</p>`;
                
                lbmCard.innerHTML = `<div class="flex items-center mb-3 text-gray-700"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg><h3 class="text-lg font-semibold">é™¤è„‚é«”é‡ (LBM)</h3></div><p class="text-3xl font-bold text-gray-800">${lbm.toFixed(1)} <span class="text-base font-medium">å…¬æ–¤</span></p><p class="text-sm text-gray-500 mt-1">è‚Œè‚‰ã€éª¨éª¼èˆ‡å™¨å®˜é‡é‡</p>`;

                whtrCard.className = `p-6 rounded-lg shadow-md ${whtrColorClass.bg}`;
                whtrCard.innerHTML = `<div class="flex items-center mb-3"><svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg><h3 class="text-lg font-semibold">è…°é«˜æ¯” (WHtR)</h3></div><p class="text-3xl font-bold ${whtrColorClass.text}">${whtr.toFixed(2)}</p><p class="text-sm font-medium mt-1 ${whtrColorClass.text}">${whtrStatus} (ç†æƒ³å€¼ < 0.5)</p>`;

                bfpCard.classList.remove('hidden');
                lbmCard.classList.remove('hidden');
                whtrCard.classList.remove('hidden');
            } else {
                // å¦‚æœé€²éšè³‡æ–™ä¸å®Œæ•´ï¼Œå‰‡éš±è—ç›¸é—œå¡ç‰‡
                bfpCard.classList.add('hidden');
                lbmCard.classList.add('hidden');
                whtrCard.classList.add('hidden');
            }

            // é¡¯ç¤ºçµæœå€
            if (resultsContainer.classList.contains('hidden')) {
                resultsContainer.classList.remove('hidden');
                resultsContainer.classList.add('fade-in');
            }
        };

        // ç‚ºæ‰€æœ‰è¼¸å…¥æ¡†æ·»åŠ  'input' äº‹ä»¶ç›£è½å™¨
        inputs.forEach(input => {
            input.addEventListener('input', calculateAndDisplay);
        });

        // é é¢è¼‰å…¥æ™‚ï¼Œæ ¹æ“šé è¨­æ€§åˆ¥ï¼ˆç”·æ€§ï¼‰è¨­å®šè‡€åœæ¬„ä½å¯è¦‹æ€§
        if (genderSelect.value === 'female') {
            hipGroup.classList.remove('hidden');
        } else {
            hipGroup.classList.add('hidden');
        }
    </script>
</body>
</html>
